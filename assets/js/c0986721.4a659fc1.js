"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[49578],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>m});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=a.createContext({}),i=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},u=function(e){var t=i(e.components);return a.createElement(p.Provider,{value:t},e.children)},l={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),d=i(r),m=n,k=d["".concat(p,".").concat(m)]||d[m]||l[m]||o;return r?a.createElement(k,s(s({ref:t},u),{},{components:r})):a.createElement(k,s({ref:t},u))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,s=new Array(o);s[0]=d;var c={};for(var p in t)hasOwnProperty.call(t,p)&&(c[p]=t[p]);c.originalType=e,c.mdxType="string"==typeof e?e:n,s[1]=c;for(var i=2;i<o;i++)s[i]=r[i];return a.createElement.apply(null,s)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},22025:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>k,frontMatter:()=>o,metadata:()=>c,toc:()=>i});var a=r(87462),n=(r(67294),r(3905));const o={id:"useCan",title:"useCan",siderbar_label:"useCan"},s=void 0,c={unversionedId:"api-reference/core/hooks/accessControl/useCan",id:"api-reference/core/hooks/accessControl/useCan",title:"useCan",description:"useCan uses the Access Control Provider's can function as the query function for TanStack Query's useQuery. It takes the parameters that can takes. It can also be configured with queryOptions for useQuery. Returns the result of useQuery.",source:"@site/docs/api-reference/core/hooks/accessControl/useCan.md",sourceDirName:"api-reference/core/hooks/accessControl",slug:"/api-reference/core/hooks/accessControl/useCan",permalink:"/docs/api-reference/core/hooks/accessControl/useCan",draft:!1,editUrl:"https://github.com/refinedev/refine/tree/master/documentation/docs/api-reference/core/hooks/accessControl/useCan.md",tags:[],version:"current",lastUpdatedBy:"Alican Erdurmaz",lastUpdatedAt:1675161069,formattedLastUpdatedAt:"Jan 31, 2023",frontMatter:{id:"useCan",title:"useCan",siderbar_label:"useCan"},sidebar:"someSidebar",previous:{title:"Router Provider",permalink:"/docs/api-reference/core/providers/router-provider"},next:{title:"useAuthenticated",permalink:"/docs/api-reference/core/hooks/auth/useAuthenticated"}},p={},i=[{value:"Basic Usage",id:"basic-usage",level:2},{value:"Performance",id:"performance",level:2},{value:"Properties",id:"properties",level:2},{value:"<code>resource</code> <PropTag required />",id:"resource-",level:3},{value:"<code>action</code> <PropTag required />",id:"action-",level:3},{value:"<code>params</code>",id:"params",level:3},{value:"<code>queryOptions</code>",id:"queryoptions",level:3},{value:"Return values",id:"return-values",level:2},{value:"API",id:"api",level:2},{value:"Properties",id:"properties-1",level:3},{value:"Type Parameters",id:"type-parameters",level:3},{value:"Return values",id:"return-values-1",level:3}],u=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,n.kt)("div",t)},l=u("PropTag"),d=u("PropsTable"),m={toc:i};function k(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"useCan")," uses the ",(0,n.kt)("a",{parentName:"p",href:"/docs/api-reference/core/providers/accessControl-provider/"},"Access Control Provider's")," ",(0,n.kt)("inlineCode",{parentName:"p"},"can")," function as the query function for ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/latest"},"TanStack Query's")," ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/latest/docs/react/guides/queries"},(0,n.kt)("inlineCode",{parentName:"a"},"useQuery")),". It takes the ",(0,n.kt)("a",{parentName:"p",href:"/docs/api-reference/core/interfaceReferences/#canparams"},"parameters")," that ",(0,n.kt)("inlineCode",{parentName:"p"},"can")," takes. It can also be configured with ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/v4/docs/react/reference/useQuery"},(0,n.kt)("inlineCode",{parentName:"a"},"queryOptions"))," for ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/latest/docs/react/guides/queries"},(0,n.kt)("inlineCode",{parentName:"a"},"useQuery")),". Returns the result of ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/latest/docs/react/guides/queries"},(0,n.kt)("inlineCode",{parentName:"a"},"useQuery")),"."),(0,n.kt)("h2",{id:"basic-usage"},"Basic Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-tsx"},'import { useCan } from "@pankod/refine-core";\n\nconst { data } = useCan({\n    resource: "resource-you-ask-for-access",\n    action: "action-type-on-resource",\n    params: { foo: "optional-params" },\n});\n')),(0,n.kt)("h2",{id:"performance"},"Performance"),(0,n.kt)("p",null,"As the number of points that checks for access control in your app increases the performance of your app may take a hit especially if its access control involves remote endpoints. Caching the access control checks helps a great deal. Since ",(0,n.kt)("strong",{parentName:"p"},"refine")," uses ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/latest"},"TanStack Query")," it can be easily done configuring ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/v4/docs/react/reference/useQuery"},(0,n.kt)("inlineCode",{parentName:"a"},"staleTime")," and ",(0,n.kt)("inlineCode",{parentName:"a"},"cacheTime"))," properties."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},'import { useCan } from "@pankod/refine-core";\n\n// inside your component\n\nconst { data } = useCan({\n    resource: "resource-you-ask-for-access",\n    action: "action-type-on-resource",\n    params: { foo: "optional-params" } },\n    queryOptions: {\n        staleTime: 5 * 60 * 1000, // 5 minutes\n    }\n});\n')),(0,n.kt)("h2",{id:"properties"},"Properties"),(0,n.kt)("h3",{id:"resource-"},(0,n.kt)("inlineCode",{parentName:"h3"},"resource")," ",(0,n.kt)(l,{required:!0,mdxType:"PropTag"})),(0,n.kt)("p",null,"Passes to ",(0,n.kt)("a",{parentName:"p",href:"/docs/api-reference/core/providers/accessControl-provider/"},"Access Control Provider's")," ",(0,n.kt)("inlineCode",{parentName:"p"},"can")," function's ",(0,n.kt)("inlineCode",{parentName:"p"},"resource")," parameter"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},'useCan({\n    resource: "resource-you-ask-for-access",\n});\n')),(0,n.kt)("h3",{id:"action-"},(0,n.kt)("inlineCode",{parentName:"h3"},"action")," ",(0,n.kt)(l,{required:!0,mdxType:"PropTag"})),(0,n.kt)("p",null,"Passes to ",(0,n.kt)("a",{parentName:"p",href:"/docs/api-reference/core/providers/accessControl-provider/"},"Access Control Provider's")," ",(0,n.kt)("inlineCode",{parentName:"p"},"can")," function's ",(0,n.kt)("inlineCode",{parentName:"p"},"action")," parameter"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},'useCan({\n    action: "resource-you-ask-for-access",\n});\n')),(0,n.kt)("h3",{id:"params"},(0,n.kt)("inlineCode",{parentName:"h3"},"params")),(0,n.kt)("p",null,"Passes to ",(0,n.kt)("a",{parentName:"p",href:"/docs/api-reference/core/providers/accessControl-provider/"},"Access Control Provider's")," ",(0,n.kt)("inlineCode",{parentName:"p"},"can")," function's ",(0,n.kt)("inlineCode",{parentName:"p"},"params")," parameter"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},'useCan({\n    params: { foo: "optional-params" },\n});\n')),(0,n.kt)("h3",{id:"queryoptions"},(0,n.kt)("inlineCode",{parentName:"h3"},"queryOptions")),(0,n.kt)("p",null,"Query options for ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/latest"},"TanStack Query's")," ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/latest/docs/react/guides/queries"},(0,n.kt)("inlineCode",{parentName:"a"},"useQuery")),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},"useCan({\n    queryOptions: {\n        staleTime: 5 * 60 * 1000, // 5 minutes\n    },\n});\n")),(0,n.kt)("h2",{id:"return-values"},"Return values"),(0,n.kt)("p",null,"Query result of ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/latest"},"TanStack Query's")," ",(0,n.kt)("a",{parentName:"p",href:"https://tanstack.com/query/latest/docs/react/guides/queries"},(0,n.kt)("inlineCode",{parentName:"a"},"useQuery")),"."),(0,n.kt)("p",null,"For example if you want to check if the user can create a post return value will be:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-tsx"},'<Refine\n    accessControlProvider={{\n        can: async ({ resource, action }) => {\n            if (resource === "post" && action === "create") {\n                return Promise.resolve({\n                    can: false,\n                    reason: "Unauthorized",\n                });\n            }\n\n            return Promise.resolve({ can: true });\n        },\n    }}\n\n    // ...\n/>;\n\n// inside your component\nconst { data: canCreatePost } = useCan({\n    action: "create",\n    resource: "post",\n});\n\nconsole.log(canCreatePost); // { can: false, reason: "Unauthorized" }\n')),(0,n.kt)("h2",{id:"api"},"API"),(0,n.kt)("h3",{id:"properties-1"},"Properties"),(0,n.kt)(d,{module:"@pankod/refine-core/useCan",mdxType:"PropsTable"}),(0,n.kt)("h3",{id:"type-parameters"},"Type Parameters"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Property"),(0,n.kt)("th",{parentName:"tr",align:null},"Desription"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"/docs/api-reference/core/interfaceReferences#canreturntype"},"CanReturnType")),(0,n.kt)("td",{parentName:"tr",align:null},"Result data of the query ",(0,n.kt)("a",{parentName:"td",href:"/docs/api-reference/core/interfaceReferences#httperror"},(0,n.kt)("inlineCode",{parentName:"a"},"HttpError")))))),(0,n.kt)("h3",{id:"return-values-1"},"Return values"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Description"),(0,n.kt)("th",{parentName:"tr",align:null},"Type"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Result of the ",(0,n.kt)("a",{parentName:"td",href:"https://tanstack.com/query/latest"},"TanStack Query's")," ",(0,n.kt)("a",{parentName:"td",href:"https://tanstack.com/query/latest/docs/react/guides/queries"},(0,n.kt)("inlineCode",{parentName:"a"},"useQuery"))),(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://tanstack.com/query/v4/docs/react/reference/useQuery"},(0,n.kt)("inlineCode",{parentName:"a"},"QueryObserverResult<{ data: CanReturnType; }>")))))))}k.isMDXComponent=!0}}]);